#Фоновое выполнение задач по расписанию

### На основе `async_cron`
Используем внутри библиотеку `async_cron`, которая позволяет запускать фоновые асинхронные задачи по расписанию
[Подробнее можно почитать здесь](https://github.com/aohan237/async_cron)

### Защита от потери задачи
Перед тем как задача отдаётся на выполнение `async_cron` она сохраняется в бд.
Если вдруг сервер перезагрузился, то при запуске приложения задачи достанутся из БД и перезапустятся

### Обработчики
Обработчики должны находится в файле src.tasks.handlers и должны быть заведены в словарь handlers
Каждый обработчик в сигнатуре помимо основных аргументов должен иметь `**_`
Это нужно для прёма всех аргументов, даже тех, которые в этой функции не нужны.
Помечаем `**_`, а не `**kwargs`, потому что `_` в python означает неиспользуемую переменную.

### Передача глобальных переменных в обработчик
При запуске приложения инициализируются `db_engine`, `aiohttp ClientSession` и т.д.
Эти переменные - синглтоны и они живут всё время работы приложения.
Что если вам нужны глобальные переменные в фоновом обработчике(Например сделать запрос в БД)?
Просто объявите их в вашей функции и вызов функции сам их передаст, главное правильно назвать аргумент.
Назвать в соответствии с тем, что передается в src.tasks.task в обработчик.
Но ведь мы потеряем контекст при перезапуске приложения?
Да, всё верно, при перезапуске возьмутся новые глобальные переменные

